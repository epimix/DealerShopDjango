{% extends "layout.html" %}

{% block content %}
<!-- Hero Section -->
<div class="bg-gradient-to-r from-blue-600 to-blue-800 rounded-2xl shadow-xl mb-12 overflow-hidden">
    <div class="px-6 py-16 sm:px-12 sm:py-20">
        <div class="max-w-3xl">
            <h1 class="text-4xl sm:text-5xl font-bold text-white mb-4">
                Welcome to DealerShop
            </h1>
            <p class="text-xl text-blue-100 mb-8">#sort</p>
            <!-- Sorting Section -->
            <form method="get" class="mb-6 flex items-center gap-4">
                <label for="sort_by" class="text-white font-semibold">Sort by:</label>
                <select name="sort_by" id="sort_by" class="rounded-lg px-3 py-2 text-blue-800">
                    <option value="price" {% if request.GET.sort_by == "price" %}selected{% endif %}>Price</option>
                    <option value="year" {% if request.GET.sort_by == "year" %}selected{% endif %}>Year</option>
                    <option value="brand" {% if request.GET.sort_by == "brand" %}selected{% endif %}>Brand</option>
                    <option value="model" {% if request.GET.sort_by == "model" %}selected{% endif %}>Model</option>
                </select>
                <select name="order" id="order" class="rounded-lg px-3 py-2 text-blue-800">
                    <option value="asc" {% if request.GET.order == "asc" %}selected{% endif %}>low to high</option>
                    <option value="desc" {% if request.GET.order == "desc" %}selected{% endif %}>high to low</option>
                </select>
                <button type="submit" class="rounded-lg bg-white px-4 py-2 text-blue-600 font-semibold hover:bg-blue-50 shadow-sm">
                    Sort
                </button>
            </form>
            {% if request.GET.sort_by %}
            <script>
                window.onload = function() {
                    location.hash = "#cars";
                }
            </script>
            {% endif %}
            <div class="flex flex-wrap gap-4">
                <a href="#cars"
                    class="inline-flex items-center gap-2 rounded-lg bg-white px-6 py-3 text-sm font-semibold text-blue-600 hover:bg-blue-50 shadow-sm">
                    Browse Cars
                    <i class="fas fa-arrow-down"></i>
                </a>
                <a href="/favorites/"
                    class="inline-flex items-center gap-2 rounded-lg border-2 border-white/30 bg-white/10 backdrop-blur px-6 py-3 text-sm font-semibold text-white hover:bg-white/20">
                    <i class="fas fa-heart"></i>
                    View Favorites
                    {% if fav_count > 0 %}
                    <span class="ml-1 px-2 py-0.5 rounded-full bg-red-500 text-xs">{{ fav_count }}</span>
                    {% endif %}
                </a>
            </div>
        </div>
    </div>
</div>

<!-- Cars Grid Section -->
<div id="cars">
    <div class="flex items-center justify-between mb-6">
        <div>
            <h2 class="text-2xl sm:text-3xl font-bold tracking-tight text-slate-900">
                Our Car Collection
            </h2>
            <p class="mt-1 text-sm text-slate-600">
                {{ cars|length }} car{{ cars|length|pluralize }} available
            </p>
        </div>
    </div>

    {% if cars %}
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
        {% for car in cars %}
        <div
            class="group rounded-2xl border border-slate-200 bg-white shadow-sm overflow-hidden hover:shadow-lg transition-all duration-300">
            <div class="relative overflow-hidden">
                {% if car.photo %}
                <img src="{{ car.photo.url }}" alt="{{ car.brand }} {{ car.model }}"
                    class="w-full h-56 object-cover group-hover:scale-105 transition-transform duration-300">
                {% else %}
                <div class="w-full h-56 bg-gradient-to-br from-slate-100 to-slate-200 flex items-center justify-center">
                    <i class="fas fa-car text-6xl text-slate-400"></i>
                </div>
                {% endif %}
                <div class="absolute top-4 right-4">
                    {% if car.id in fav_cars %}
                    <a href="{% url 'favorites:remove_car' car.id 'car_index' %}"
                        class="inline-flex items-center justify-center w-10 h-10 rounded-full bg-red-500 text-white shadow-lg hover:bg-red-600 transition-colors">
                        <i class="fas fa-heart"></i>
                    </a>
                    {% else %}
                    <a href="{% url 'favorites:add_car' car.id 'car_index' %}"
                        class="inline-flex items-center justify-center w-10 h-10 rounded-full bg-white/90 backdrop-blur text-red-500 shadow-lg hover:bg-white transition-colors">
                        <i class="far fa-heart"></i>
                    </a>
                    {% endif %}
                </div>
            </div>
            <div class="p-5">
                <h3 class="text-xl font-bold text-slate-900 mb-2">
                    {{ car.year }} {{ car.brand }} {{ car.model }}
                </h3>
                <div class="flex items-center gap-4 text-sm text-slate-600 mb-4">
                    <span class="flex items-center gap-1">
                        <i class="fas fa-tag text-blue-500"></i>
                        {{ car.get_type_display }}
                    </span>
                    <span class="flex items-center gap-1">
                        <i class="fas fa-calendar text-blue-500"></i>
                        {{ car.year }}
                    </span>
                </div>
                <div class="flex items-center justify-between mb-4">
                    <div>
                        <span class="text-2xl font-bold text-blue-600">${{ car.price|floatformat:0 }}</span>
                    </div>
                </div>
                <a href="{% url 'car_detail' car.pk %}"
                    class="block w-full text-center rounded-lg bg-blue-600 px-4 py-2.5 text-sm font-semibold text-white hover:bg-blue-700 shadow-sm transition-colors">
                    View Details
                    <i class="fas fa-arrow-right ml-2"></i>
                </a>
            </div>
        </div>
        {% endfor %}
    </div>
    {% else %}
    <div class="rounded-2xl border border-slate-200 bg-white shadow-sm p-12 text-center">
        <i class="fas fa-car text-6xl text-slate-300 mb-4"></i>
        <h2 class="text-xl font-semibold text-slate-900 mb-2">No cars available</h2>
        <p class="text-slate-600">Check back later for new arrivals!</p>
    </div>
    {% endif %}
</div>
{% endblock %}